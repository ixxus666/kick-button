local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local PlayerGui = player:WaitForChild("PlayerGui")
local SAVE_FILE = "kick_ui_pos.txt"
local THEME_FILE = "kick_ui_theme.txt"

pcall(function()
	PlayerGui:FindFirstChild("DeltaKickUI"):Destroy()
end)

local gui = Instance.new("ScreenGui")
gui.Name = "DeltaKickUI"
gui.ResetOnSpawn = false
gui.Parent = PlayerGui

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0,200,0,110)
frame.BackgroundColor3 = Color3.fromRGB(30,30,35)
frame.BorderSizePixel = 0
frame.Parent = gui
Instance.new("UICorner", frame).CornerRadius = UDim.new(0,16)

local gradient = Instance.new("UIGradient")
gradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(40,40,45)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(25,25,30))
}
gradient.Parent = frame

local kickBtn = Instance.new("TextButton")
kickBtn.Size = UDim2.new(1,-20,0,40)
kickBtn.Position = UDim2.new(0,10,0,20)
kickBtn.Text = "Kick"
kickBtn.Font = Enum.Font.GothamBold
kickBtn.TextSize = 15
kickBtn.TextColor3 = Color3.fromRGB(255,255,255)
kickBtn.BackgroundColor3 = Color3.fromRGB(220,60,60)
kickBtn.BorderSizePixel = 0
kickBtn.Parent = frame
Instance.new("UICorner", kickBtn).CornerRadius = UDim.new(0,14)

local discordLabel = Instance.new("TextLabel")
discordLabel.Size = UDim2.new(1,-20,0,20)
discordLabel.Position = UDim2.new(0,10,0,65)
discordLabel.BackgroundTransparency = 1
discordLabel.Text = "discord.gg/A5BjXj6Kkf"
discordLabel.Font = Enum.Font.GothamBold
discordLabel.TextSize = 14
discordLabel.TextColor3 = Color3.fromRGB(180,180,180)
discordLabel.TextScaled = false
discordLabel.TextWrapped = true
discordLabel.TextXAlignment = Enum.TextXAlignment.Center
discordLabel.Parent = frame

local toggleBtn = Instance.new("ImageButton")
toggleBtn.Size = UDim2.new(0,24,0,24)
toggleBtn.Position = UDim2.new(1,-28,0,4)
toggleBtn.BackgroundTransparency = 1
toggleBtn.Parent = frame

local ICON_SUN = "rbxassetid://12948413735"
local ICON_MOON = "rbxassetid://12948414321"

local function loadPos()
	if readfile and isfile and isfile(SAVE_FILE) then
		local d = readfile(SAVE_FILE)
		local xS,xO,yS,yO = d:match("(.+),(.+),(.+),(.+)")
		if xS then
			frame.Position = UDim2.new(
				tonumber(xS), tonumber(xO),
				tonumber(yS), tonumber(yO)
			)
			return
		end
	end
	frame.Position = UDim2.new(0.5, -100, 0.7, 0)
end

local function savePos()
	if writefile then
		local p = frame.Position
		writefile(SAVE_FILE, table.concat({
			p.X.Scale,p.X.Offset,p.Y.Scale,p.Y.Offset
		},","))
	end
end

loadPos()

local dragging, dragStart, startPos
frame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1
	or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = frame.Position
	end
end)
frame.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1
	or input.UserInputType == Enum.UserInputType.Touch then
		dragging = false
		savePos()
	end
end)
UIS.InputChanged:Connect(function(input)
	if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement
	or input.UserInputType == Enum.UserInputType.Touch) then
		local delta = input.Position - dragStart
		frame.Position = UDim2.new(
			startPos.X.Scale,
			startPos.X.Offset+delta.X,
			startPos.Y.Scale,
			startPos.Y.Offset+delta.Y
		)
	end
end)

local hoverTween = TweenService:Create(kickBtn, TweenInfo.new(0.15), {BackgroundColor3=Color3.fromRGB(200,50,50)})
local normalTween = TweenService:Create(kickBtn, TweenInfo.new(0.15), {BackgroundColor3=Color3.fromRGB(220,60,60)})
kickBtn.InputBegan:Connect(function() hoverTween:Play() end)
kickBtn.InputEnded:Connect(function() normalTween:Play() end)
kickBtn.Activated:Connect(function() player:Kick("Kick Was Successful.") end)

local theme = "Dark"
local function applyTheme(t)
	if t=="Dark" then
		frame.BackgroundColor3 = Color3.fromRGB(30,30,35)
		gradient.Color = ColorSequence.new{ColorSequenceKeypoint.new(0,Color3.fromRGB(40,40,45)),ColorSequenceKeypoint.new(1,Color3.fromRGB(25,25,30))}
		kickBtn.BackgroundColor3 = Color3.fromRGB(220,60,60)
		kickBtn.TextColor3 = Color3.fromRGB(255,255,255)
		toggleBtn.Image = ICON_MOON
		discordLabel.TextColor3 = Color3.fromRGB(180,180,180)
	else
		frame.BackgroundColor3 = Color3.fromRGB(240,240,245)
		gradient.Color = ColorSequence.new{ColorSequenceKeypoint.new(0,Color3.fromRGB(250,250,250)),ColorSequenceKeypoint.new(1,Color3.fromRGB(225,225,230))}
		kickBtn.BackgroundColor3 = Color3.fromRGB(200,50,50)
		kickBtn.TextColor3 = Color3.fromRGB(255,255,255)
		toggleBtn.Image = ICON_SUN
		discordLabel.TextColor3 = Color3.fromRGB(100,100,100)
	end
end

if readfile and isfile and isfile(THEME_FILE) then
	local t = readfile(THEME_FILE)
	if t=="Light" or t=="Dark" then theme = t end
end
applyTheme(theme)

toggleBtn.Activated:Connect(function()
	if theme=="Dark" then theme="Light" else theme="Dark" end
	applyTheme(theme)
	if writefile then writefile(THEME_FILE,theme) end
end)
